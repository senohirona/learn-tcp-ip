# ここがkey

## 荷物の届け先
トランスポート層の役割は「データを相手に届けること」
「相手のアプリケーション層にあるどのプロトコルに渡すか」まで責任を持って受け持つ

## TCPとUDP
TCP: 「データを安全/確実に届けること」をモットーにしたプロトコル。データが途中で破損したり、何らかの事情で相手に届かなかったときなどには再送する働きがある。
UDP: 「データを素早く届けること」をモットーにしたプロトコル。相手にどんどんデータを送りつけるだけで、その後のフォローはしない。UDPが重宝されるのは、リアルタイム性が問われるIP電話やストリーミング配信など。

# トランスポート層の役割
## 位置づけ
トランスポート層は、アプリケーション層とネットワーク層の橋渡しをする

## 相手に届ける
データはいつも確実に届くとは限らないので、問題が起こったときには何らかの対処が必要になる。
このとき、通信サービスに合った方法で対応するのがトランスポート層の役割。

# 信頼性を撮るか、速度を取るか
トランスポート層にはTCP(Transmission Control Protocol)とUDP(User Datagram Protocol)という2つのプロトコルがある。
TCPは信頼性を、UDPは速度を重視したプロトコル

- TCP: 送信するデータを確実に相手先に届けたいときに使う。 WWW, 電子メール等
- UDP: 送信するパケットが小さいときや、データを再送する必要のないときに使う。 IP電話, ストリーミング配信等

# アプリケーションの玄関
## アプリケーション層の出入り口
ポート: アプリケーション層にある、アプリケーションプロトコルごとに用意されたデータの出入り口。各ポートにはポート番号が振られている。通信を行うときには、ポート番号を使って行き先を指定する。

## ポート番号
ポート番号は0~65535番まである。

ウェルノウンポート: 0~1023番までの通信サービスごとに予め予約されているポート番号

### 主なサービスのウェルノウンポート番号

|サービス|アプリケーション層のプロトコル|ポート番号|トランスポート層のプロトコル|
--|--|--|--
|WWW|HTTP|80|TCP/UDP|
|WWW(セキュリティ付き)|HTTPS|443|TCP/UDP|
|電子メール(送信)|SMTP|25|TCP/UDP|
|電子メール(受信)|POP3|110|TCP/UDP|
|電子メール(認証付き送信)|SMTP|587|TCP|
|ファイル転送|FTP|20/21|TCP/UDP|
|遠隔ログイン|TELNET|23|TCP/UDP|
|遠隔ログイン(セキュリティ付き)|SSH|22|TCP/UDP|
|ネットニューズ|NNTP1190|TCP/UDP|
|ネットワーク管理 DNS|DNS|53|TCP/UDP|
|ネットワーク管理 DHCP|DHCP|546/547|UDP|
|ネットワーク管理 SNMP|SNMP|161/162|UDP|

# TCPプロトコル

## 1対1の通信
TCPは、データを確実に届けるために、受信側と1対1で通信を行う。

このような通信をコネクション通信といい、大まかには次の3ステップから成り立っている。

1. 受信側がデータを受け取れる状態かどうかを確認してから通信を開始する。
これを「通信を確立する」という。

2. データを決められた大きさに分割し、TCPヘッダを付けて順番に送信する。
(トランスポート層で扱うデータの単位をセグメントという。)

3. データを贈り終わったら通信を終了する。

